{"ast":null,"code":"import _regeneratorRuntime from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"E:\\\\2023_2024\\\\IUH_HK2_2022_2023\\\\LTPTDL2\\\\dbank-master\\\\client\\\\src\\\\components\\\\App.js\";\nimport React, { Component } from 'react';\nimport LoginForm from \"./Login\";\nimport Admin from \"./admin\";\nimport User from \"./User\";\nimport io from 'socket.io-client';\nimport { BrowserRouter as Router, Route, useLocation } from \"react-router-dom\";\nimport { Routes } from 'react-router-dom';\nimport Token from '../abis/Token.json';\nimport dBank from '../abis/dBank.json';\nimport Web3 from 'web3';\nvar socket = io('http://localhost:3000');\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  _createClass(App, [{\n    key: \"Connect\",\n    value: function () {\n      var _Connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n        var web3, netId, accounts, balance, token, dbank, dBankAddress;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(typeof window.ethereum !== 'undefined')) {\n                  _context.next = 24;\n                  break;\n                }\n\n                web3 = new Web3(window.ethereum);\n                _context.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                _context.next = 6;\n                return web3.eth.net.getId();\n\n              case 6:\n                netId = _context.sent;\n                _context.next = 9;\n                return web3.eth.getAccounts();\n\n              case 9:\n                accounts = _context.sent;\n\n                if (!(typeof accounts[0] !== 'undefined')) {\n                  _context.next = 17;\n                  break;\n                }\n\n                _context.next = 13;\n                return web3.eth.getBalance(accounts[0]);\n\n              case 13:\n                balance = _context.sent;\n                this.setState({\n                  account: accounts[0],\n                  balance: balance,\n                  web3: web3\n                });\n                _context.next = 18;\n                break;\n\n              case 17:\n                window.alert('Please login with MetaMask');\n\n              case 18:\n                token = new web3.eth.Contract(Token.abi, Token.networks[netId].address);\n                dbank = new web3.eth.Contract(dBank.abi, dBank.networks[netId].address);\n                dBankAddress = dBank.networks[netId].address;\n                this.setState({\n                  token: token,\n                  dbank: dbank,\n                  dBankAddress: dBankAddress,\n                  role: 'user'\n                });\n                _context.next = 25;\n                break;\n\n              case 24:\n                window.alert('Please install MetaMask');\n\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function Connect(_x) {\n        return _Connect.apply(this, arguments);\n      }\n\n      return Connect;\n    }()\n  }]);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      web3: 'undefined',\n      account: '',\n      token: null,\n      dbank: null,\n      balance: 0,\n      dBankAddress: null,\n      role: ''\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        onLoad: this.Connect(this.props.dispatch),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Router, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Routes, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Route, {\n        path: \"/admin\",\n        element: /*#__PURE__*/React.createElement(Admin, {\n          socket: socket,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 45\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(Route, {\n        path: \"/user\",\n        element: /*#__PURE__*/React.createElement(User, {\n          socket: socket,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 43\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 11\n        }\n      }))), this.state.role = 'user');\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["E:/2023_2024/IUH_HK2_2022_2023/LTPTDL2/dbank-master/client/src/components/App.js"],"names":["React","Component","LoginForm","Admin","User","io","BrowserRouter","Router","Route","useLocation","Routes","Token","dBank","Web3","socket","App","dispatch","window","ethereum","web3","enable","eth","net","getId","netId","getAccounts","accounts","getBalance","balance","setState","account","alert","token","Contract","abi","networks","address","dbank","dBankAddress","role","props","state","Connect"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport LoginForm from \"./Login\"\nimport Admin from \"./admin\"\nimport User from \"./User\"\nimport io from 'socket.io-client';\nimport {\n    BrowserRouter as Router,\n    Route,\n    useLocation\n}from \"react-router-dom\"\nimport { Routes  } from 'react-router-dom';\nimport Token from '../abis/Token.json';\nimport dBank from '../abis/dBank.json';\nimport Web3 from 'web3';\nconst socket = io('http://localhost:3000');\nclass App extends Component {\n  async Connect(dispatch) {\n  if(typeof window.ethereum !== 'undefined'){\n      const web3 = new Web3(window.ethereum)\n      await window.ethereum.enable();\n      const netId = await web3.eth.net.getId()\n      const accounts = await web3.eth.getAccounts()\n      if(typeof accounts[0] !== 'undefined'){\n        const balance = await web3.eth.getBalance(accounts[0])\n        this.setState({account: accounts[0], balance: balance, web3: web3})\n      } else {\n        window.alert('Please login with MetaMask')\n      }\n        const token = new web3.eth.Contract(Token.abi, Token.networks[netId].address)\n        const dbank = new web3.eth.Contract(dBank.abi, dBank.networks[netId].address)\n        const dBankAddress = dBank.networks[netId].address\n      this.setState({token: token, dbank: dbank, dBankAddress: dBankAddress, role: 'user'})\n    }else {\n      window.alert('Please install MetaMask')\n    }}\n  constructor(props) {\n    super(props)\n    this.state = {\n      web3: 'undefined',\n      account: '',\n      token: null,\n      dbank: null,\n      balance: 0,\n      dBankAddress: null,\n      role: ''\n    }}\n  render(){\n      return(\n          <div onLoad={this.Connect(this.props.dispatch)}>\n          <Router  >\n          <Routes>\n          <Route path = '/admin' element = {<Admin socket = {socket}/>} />\n          <Route path = '/user' element ={<User socket = {socket}/>} />\n            </Routes>\n          </Router>\n            {this.state.role = 'user' }\n          </div>\n      )\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}